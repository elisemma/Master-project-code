import numpy as np
import matplotlib.pyplot as plt 


# _________________________ dp = 1.0 for both stacks ________________________________________
data_before_var_min = {
    r'$^{nat}$Ti(d,x)$^{48}$V': {
        'beam_current': [91.71196554277911, 91.3850674818779, 93.99227877866085, 90.19868197781902, 86.54487112924936, 122.61698550036196, 119.23766047986943, 172.43443251898097, 254.10392377023086], 
        'beam_current_unc': [12.588719695262503, 10.224766057926704, 10.106654535193414, 10.22988436568773, 8.97253019970167, 12.875197107034467, 12.49614031027918, 19.610273439430426, 53.392427109556714], 
        'energy': [47.06680673333333, 40.399932099999994, 35.51257269999999, 30.03057203333334, 23.618044199999993, 25.405422279999993, 17.705420339999996, 9.946734590000002, 2.85505377533087]}, 

    r'$^{nat}$Ti(d,x)$^{46}$Sc': {
        'beam_current': [99.25473522058245, 94.78881069343146, 97.9855060334681, 93.87079573878829, 90.89734180073842, 119.85741237387647, 114.20769040433147, 138.39158225082664, 158.09389433045777], 
        'beam_current_unc': [9.140384129803786, 8.411536858942652, 8.443525692222652, 8.800579100644198, 7.509626409079542, 10.100982550365638, 9.605968260102369, 12.152739879347378, 25.83382276014169], 
        'energy': [47.06680673333333, 40.399932099999994, 35.51257269999999, 30.03057203333334, 23.618044199999993, 25.405422279999993, 17.705420339999996, 9.946734590000002, 2.85505377533087]},

    r'$^{nat}$Fe(d,x)$^{56}$Co': {
        'beam_current': [91.67115044049997, 95.4137281436408, 95.6615568403795, 85.32320453389137, 74.9716836460703], 
        'beam_current_unc': [17.8767057948429, 17.50257283661169, 16.44446977232496, 12.68747293241663, 9.14105240696075], 
        'energy': [48.21263493333332, 41.6883507, 36.938826899999995, 31.647871099999996, 25.547466500000006]},

    r'$^{nat}$Ni(d,x)$^{56}$Co': {
        'beam_current': [144.19088933220593, 137.32715527847336, 124.67440645281644, 131.03552205800284], 
        'beam_current_unc': [16.304908263993678, 17.049636083675832, 14.596170783033505, 15.97634396836813], 
        'energy': [27.271889139999995, 20.124639795, 13.426894577142855, 7.6822559601352145]}, 

    r'$^{nat}$Ni(d,x)$^{58}$Co': {
        'beam_current': [119.6489680978192, 130.69649909129748, 142.79575497722158, 184.9826366185086],
        'beam_current_unc': [12.93846237036795, 14.166128105885091, 17.41826374334366, 31.75245898377113], 
        'energy': [27.271889139999995, 20.124639795, 13.426894577142855, 7.6822559601352145]}, 

    r'$^{nat}$Ni(d,x)$^{61}$Cu': {
        'beam_current': [144.95952784641472, 113.58504833824993, 118.55493857324164, 98.77350097477888],     
        'beam_current_unc': [15.51979099211695, 11.728540481227677, 11.286265228026252, 13.828331195212847], 
        'energy': [27.271889139999995, 20.124639795, 13.426894577142855, 7.6822559601352145]}} 
# _____________________________________________________________________________________________






# _________________________ dp = 0.972 for 30 MeV, dp = 0.99 for 50 MeV________________________
data_after_var_min = {
     r'$^{nat}$Ti(d,x)$^{48}$V': {
        'beam_current': [91.76279410520966, 91.76427218744738, 94.73899437338731, 91.92289189263836, 89.57537766869422, 124.24905346888342, 120.45635827792036, 120.75789499180249, 125.97321213089911], 
        'beam_current_unc': [12.610055941263163, 10.279792929471318, 10.190216978411376, 10.440332545328687, 9.289141582970178, 13.044917518433676, 12.594543763041111, 13.077666870850727, 27.03408006522823], 
        'energy': [47.09795026666667, 40.50592943333334, 35.68120613333333, 30.28116373333334, 23.99016156666667, 25.542917359999997, 18.134367400000002, 10.866410484000001, 3.9274296448168275]}, 

    r'$^{nat}$Ti(d,x)$^{46}$Sc': {
        'beam_current': [99.14854343832273, 93.94317721163227, 96.80134065374573, 93.59057325769712, 90.64915956974917, 119.7043426397923, 116.91696038577017, 125.49696608010343, 61.26957739268947], 
        'beam_current_unc': [9.131366995365276, 8.340736045381597, 8.347731088799447, 8.77906515572666, 7.490193553873115, 10.09333188333647, 9.816366726559183, 10.842103608803457, 7.164281333735599], 
        'energy': [47.09795026666667, 40.50592943333334, 35.68120613333333, 30.28116373333334, 23.99016156666667, 25.542917359999997, 18.134367400000002, 10.866410484000001, 3.9274296448168275]},

    r'$^{nat}$Fe(d,x)$^{56}$Co': {
        'beam_current': [91.71880158124877, 95.78100089075812, 96.48427721673022, 86.86262138690556, 77.50865909636924], 
        'beam_current_unc': [17.891708747783195, 17.5866562281021, 16.63347826653598, 13.01251633646137, 9.55278236700333], 
        'energy': [48.2318781, 41.779047799999994, 37.08828046666665, 31.872687066666668, 25.879117466666663]},

    r'$^{nat}$Ni(d,x)$^{56}$Co': {
        'beam_current': [142.6690228199885, 141.07493375244087, 140.07551879558267, 113.488439539866], 
        'beam_current_unc': [16.13653401452156, 17.586330818269932, 16.52981786203812, 13.584181291586818], 
        'energy': [27.35133924, 20.450330565, 14.083908879999997, 8.848522071305181]}, 

    r'$^{nat}$Ni(d,x)$^{58}$Co': {
        'beam_current': [120.34076867910537, 131.872740763852, 129.71411332064656, 116.97748057168313], 
        'beam_current_unc': [13.01330924777981, 14.247413889265868, 15.582529477671539, 18.750063129542692], 
        'energy': [27.35133924, 20.450330565, 14.083908879999997, 8.848522071305181]}, 

    r'$^{nat}$Ni(d,x)$^{61}$Cu': {
        'beam_current': [145.22318046876342, 115.00384784884434, 128.18135577071817, 105.91168407157757], 
        'beam_current_unc': [15.54808323491192, 11.936098772249416, 12.268685839683723, 12.10442484188049], 
        'energy': [27.35133924, 20.450330565, 14.083908879999997, 8.848522071305181]},

    'Weighted average': {
        'beam_current': [93.2361029, 93.03944316, 96.77483054, 92.47225465, 89.66322308, 125.5537772, 128.2548745, 129.1708356, 99.94170135], 
        'beam_current_unc': [2.206923855, 1.650771896, 1.238405788, 2.646392702, 2.461530228, 3.578000348, 3.344435983, 2.591699044, 4.961873271], 
        'energy': [47.63516853, 41.11050957, 36.351075, 31.04155407, 24.8961017, 26.39531264, 19.24171826, 12.44547236, 6.346733794]}}
# _____________________________________________________________________________________________





marker_list = ['d', '*', 's', '<', 'o', '>', 'P']
color_list = ['hotpink', 'mediumaquamarine', 'cornflowerblue', 'grey', 'mediumorchid', 'deepskyblue', 'black']
# color_list = ['hotpink', 'g', 'cornflowerblue', 'grey', 'mediumorchid', 'deepskyblue', 'black']



# Loop over every reaction
plt.figure(figsize=(8, 6))
for i, (reaction, data) in enumerate(data_before_var_min.items()):
    beam_currents = data['beam_current']
    beam_currents_unc = data['beam_current_unc']
    energies = data['energy']

    plt.errorbar(energies, beam_currents, yerr=beam_currents_unc, marker=marker_list[i], markersize=8, linestyle='', capsize=3, color=color_list[i], label=reaction)


plt.xlabel('Deuteron Energy (MeV)', fontsize=14)
plt.ylabel('Beam Current (nA)', fontsize=14)
plt.xlim((0,50))
plt.ylim((0, 315))
plt.legend(fontsize=12)
plt.tick_params(axis='both', which='major', labelsize=12)
# plt.savefig(f'./Figures/PhD/beam_currents_before_var_min.pdf', dpi=600)
plt.show()


# Loop over every reaction
plt.figure(figsize=(8, 6))
for i, (reaction, data) in enumerate(data_after_var_min.items()):
    beam_currents = data['beam_current']
    beam_currents_unc = data['beam_current_unc']
    energies = data['energy']

    plt.errorbar(energies, beam_currents, yerr=beam_currents_unc, marker=marker_list[i], markersize=8, linestyle='', capsize=3, color=color_list[i], label=reaction)


plt.xlabel('Deuteron Energy (MeV)', fontsize=14)
plt.ylabel('Beam Current (nA)', fontsize=14)
plt.xlim((0,50))
plt.ylim((0, 315))
plt.legend(fontsize=12)
plt.tick_params(axis='both', which='major', labelsize=12)
# plt.savefig(f'./Figures/PhD/beam_currents_after_var_min.pdf', dpi=600)
plt.show()